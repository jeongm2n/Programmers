-- 코드를 작성해주세요
SELECT b.EMP_NO, EMP_NAME, 
CASE WHEN SCORE>=96 THEN 'S'
WHEN SCORE>=90 THEN 'A'
WHEN SCORE>=80 THEN 'B'
ELSE 'C' END as GRADE,
CASE WHEN SCORE>=96 THEN SAL*0.2
WHEN SCORE>=90 THEN SAL*0.15
WHEN SCORE>=80 THEN SAL*0.1
ELSE SAL*0 END as BONUS
FROM (SELECT EMP_NO, AVG(SCORE) as SCORE
     FROM HR_GRADE
     WHERE YEAR=2022
     GROUP BY EMP_NO) as a, HR_EMPLOYEES as b
WHERE a.EMP_NO=b.EMP_NO
ORDER BY 1;